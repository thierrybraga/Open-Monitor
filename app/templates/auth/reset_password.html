{% extends "core/base.html" %}

{% block title %}Redefinir Senha - Open Monitor{% endblock %}

{% block extra_css %}{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-card">
        <div class="auth-header">
            <h2>Redefinir Senha</h2>
            <p>Digite sua nova senha abaixo</p>
        </div>
        
        <form method="POST" class="auth-form" novalidate>
            {{ csrf_token() }}
            
            <div class="form-group">
                <label for="password" class="form-label required">Nova senha</label>
                <div class="input-group">
                  <input type="password" id="password" name="password" class="form-control" required 
                         placeholder="Digite sua nova senha" autocomplete="new-password" minlength="8"
                         aria-describedby="passwordHelp passwordFeedback">
                  <button class="btn btn-outline-secondary" type="button" id="togglePassword" aria-label="Mostrar/ocultar senha">
                    <i class="bi bi-eye" id="togglePasswordIcon"></i>
                  </button>
                </div>
                <div class="invalid-feedback" id="passwordFeedback"></div>
                <small id="passwordHelp" class="form-text text-muted">Mínimo de 8 caracteres, use letras, números e símbolos.</small>
            </div>
            
            <div class="form-group">
                <label for="confirm_password" class="form-label required">Confirmar senha</label>
                <div class="input-group">
                  <input type="password" id="confirm_password" name="confirm_password" class="form-control" required 
                         placeholder="Confirme sua nova senha" autocomplete="new-password" minlength="8"
                         aria-describedby="confirmPasswordFeedback">
                  <button class="btn btn-outline-secondary" type="button" id="toggleConfirmPassword" aria-label="Mostrar/ocultar senha">
                    <i class="bi bi-eye" id="toggleConfirmPasswordIcon"></i>
                  </button>
                </div>
                <div class="invalid-feedback" id="confirmPasswordFeedback"></div>
                <div class="password-match mt-2" id="passwordMatch" style="display: none;"></div>
                <div class="password-mismatch mt-2" id="passwordMismatch" style="display: none;"></div>
            </div>
            
            <div class="password-strength mt-2">
              <div class="password-strength-bar"><div class="password-strength-fill" id="passwordStrengthFill"></div></div>
              <small class="password-strength-text" id="passwordStrengthText">Digite uma senha</small>
            </div>
            
            <button type="submit" class="btn btn-primary btn-full" id="reset-btn" aria-live="polite">
              <span class="btn-text"><i class="bi bi-shield-lock me-2"></i> Redefinir senha</span>
              <span class="btn-loading" style="display: none;">
                <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                Processando...
              </span>
            </button>
        </form>
        
        <div class="auth-footer">
            <p><a href="{{ url_for('main.index') }}">Voltar ao Início</a></p>
            <p>Link expirado? <a href="{{ url_for('auth.forgot_password') }}">Solicitar Novo Link</a></p>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/pages/auth.js') }}" defer nonce="{{ nonce }}"></script>
<script src="{{ url_for('static', filename='js/pages/reset-password.js') }}" defer nonce="{{ nonce }}"></script>
{% endblock %}
